{"ast":null,"code":"import { Usuario } from 'src/app/models/usuario';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/login/usuario.service\";\nimport * as i2 from \"ngx-toastr\";\nimport * as i3 from \"ngx-spinner\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@ng-bootstrap/ng-bootstrap\";\nconst _c0 = (a0, a1) => ({\n  \"is-invalid\": a0,\n  \"is-valid\": a1\n});\nfunction AdministrarUsuariosComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.mensajeError, \"\\n\");\n  }\n}\nfunction AdministrarUsuariosComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵtext(1, \" Email inv\\u00E1lido \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AdministrarUsuariosComponent_option_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const rol_r4 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", rol_r4, \" \");\n  }\n}\nfunction AdministrarUsuariosComponent_tr_34_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\")(6, \"a\", 22);\n    i0.ɵɵlistener(\"click\", function AdministrarUsuariosComponent_tr_34_Template_a_click_6_listener() {\n      const usuario_r6 = i0.ɵɵrestoreView(_r5).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.editarUsuario(usuario_r6));\n    });\n    i0.ɵɵelementStart(7, \"i\", 23);\n    i0.ɵɵtext(8, \"editar\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"a\", 22);\n    i0.ɵɵlistener(\"click\", function AdministrarUsuariosComponent_tr_34_Template_a_click_9_listener() {\n      const usuario_r6 = i0.ɵɵrestoreView(_r5).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.eliminarUsuario(usuario_r6.idUsuario));\n    });\n    i0.ɵɵelementStart(10, \"i\", 23);\n    i0.ɵɵtext(11, \"delete\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const usuario_r6 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(usuario_r6.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(usuario_r6.rolDeUsuario);\n  }\n}\nexport let AdministrarUsuariosComponent = /*#__PURE__*/(() => {\n  class AdministrarUsuariosComponent {\n    usuarioService;\n    toastr;\n    spinner;\n    roles;\n    rolSeleccionado;\n    usuarioSeleccionado = new Usuario();\n    hayError;\n    mensajeError;\n    editarBandera = false;\n    constructor(usuarioService, toastr, spinner) {\n      this.usuarioService = usuarioService;\n      this.toastr = toastr;\n      this.spinner = spinner;\n      this.hayError = false;\n      this.mensajeError = \"Ha ocurrido un error\";\n      this.roles = ['SUPERVISOR', 'ADMINISTRATIVO'];\n    }\n    ngOnInit() {\n      this.getUsuarios();\n      this.editarBandera = false;\n      this.usuarioSeleccionado = new Usuario();\n    }\n    getUsuarios() {\n      this.spinner.show();\n      this.usuarioService.getUsuarios().subscribe(res => {\n        this.spinner.hide();\n        this.usuarioService.usuarios = res;\n        console.log(res);\n      });\n    }\n    agregarUsuario(usuarioForm) {\n      this.spinner.show();\n      //EDITO SI LA BANDERA ES TRUE\n      if (this.editarBandera == true) {\n        this.usuarioSeleccionado.rolDeUsuario = this.rolSeleccionado;\n        this.usuarioService.putUsuario(this.usuarioSeleccionado).subscribe(res => {\n          this.spinner.hide();\n          this.toastr.success('Usuario modificado correctamente', 'Modificado!');\n          this.getUsuarios();\n          usuarioForm.reset();\n          this.editarBandera = false;\n          this.usuarioSeleccionado = new Usuario();\n        });\n      }\n      //GUARDO SI LA BANDERA ES FALSE\n      else {\n        this.usuarioSeleccionado.rolDeUsuario = this.rolSeleccionado;\n        //POR AHORA ESTA POR DEFECTO ESTA CONTRASEÑA EN EL MODEL\n        this.usuarioService.postUsuario(this.usuarioSeleccionado).subscribe(res => {\n          this.spinner.hide();\n          var error = res;\n          if (error.hayError) {\n            //MOSTRAR ERROR\n            this.editarBandera = false;\n          } else {\n            this.toastr.success('Usuario agregado correctamente', 'Agregado!');\n            this.getUsuarios();\n            usuarioForm.reset();\n            this.editarBandera = false;\n            this.usuarioSeleccionado = new Usuario();\n          }\n        });\n      }\n    }\n    editarUsuario(usuario) {\n      this.usuarioSeleccionado = usuario;\n      this.rolSeleccionado = usuario.rolDeUsuario;\n      this.editarBandera = true;\n    }\n    eliminarUsuario(idUsuario) {\n      this.spinner.show();\n      this.usuarioService.deleteUsuario(idUsuario).subscribe(res => {\n        this.spinner.hide();\n        var error = res;\n        if (error.hayError) {\n          //MOSTRAR ERROR\n          this.toastr.error(\"\" + error.mensajeError, \"Error!\");\n        } else {\n          this.toastr.success('Usuario eliminado correctamente', 'Eliminado!');\n          this.getUsuarios();\n        }\n      });\n    }\n    static ɵfac = function AdministrarUsuariosComponent_Factory(t) {\n      return new (t || AdministrarUsuariosComponent)(i0.ɵɵdirectiveInject(i1.UsuarioService), i0.ɵɵdirectiveInject(i2.ToastrService), i0.ɵɵdirectiveInject(i3.NgxSpinnerService));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AdministrarUsuariosComponent,\n      selectors: [[\"app-administrar-usuarios\"]],\n      decls: 35,\n      vars: 11,\n      consts: [[\"usuarioForm\", \"ngForm\"], [\"email\", \"ngModel\"], [\"class\", \"alert alert-danger\", \"role\", \"alert\", 4, \"ngIf\"], [\"type\", \"ball-pulse-sync\", \"size\", \"medium\", \"bdColor\", \"rgba(51,51,51,0.5)\"], [2, \"font-size\", \"15px\", \"font-weight\", \"bold\", \"color\", \"white\"], [1, \"container\"], [1, \"row\"], [1, \"col-4\"], [1, \"card\", \"bg-light\", \"mb-3\", 2, \"max-width\", \"20rem\"], [1, \"card-body\"], [\"novalidate\", \"\", 3, \"ngSubmit\"], [\"type\", \"email\", \"name\", \"email\", \"placeholder\", \"Email\", \"ngbTooltip\", \"Email\", \"pattern\", \"[a-z0-9._%+-]+@[a-z0-9.-]+\\\\.[a-z]{2,4}$\", \"required\", \"\", \"email\", \"\", 1, \"form-control\", 3, \"ngModelChange\", \"ngClass\", \"ngModel\"], [\"class\", \"invalid-feedback d-block\", 4, \"ngIf\"], [1, \"form-group\", \"btn-block\"], [\"name\", \"rolSeleccionado\", \"ngbTooltip\", \"Rol de usuario\", \"required\", \"\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"btn-primary\", \"btn-block\", 3, \"disabled\"], [1, \"col\"], [1, \"table\", \"table-striped\"], [\"scope\", \"col\"], [\"role\", \"alert\", 1, \"alert\", \"alert-danger\"], [1, \"invalid-feedback\", \"d-block\"], [3, \"click\"], [1, \"material-icons\"]],\n      template: function AdministrarUsuariosComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵtemplate(0, AdministrarUsuariosComponent_div_0_Template, 2, 1, \"div\", 2);\n          i0.ɵɵelementStart(1, \"ngx-spinner\", 3)(2, \"p\", 4);\n          i0.ɵɵtext(3, \"Cargando...\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(4, \"div\", 5)(5, \"div\", 6)(6, \"div\", 7)(7, \"div\", 8)(8, \"div\", 9)(9, \"legend\");\n          i0.ɵɵtext(10, \"Usuario\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(11, \"form\", 10, 0);\n          i0.ɵɵlistener(\"ngSubmit\", function AdministrarUsuariosComponent_Template_form_ngSubmit_11_listener() {\n            i0.ɵɵrestoreView(_r1);\n            const usuarioForm_r3 = i0.ɵɵreference(12);\n            return i0.ɵɵresetView(ctx.agregarUsuario(usuarioForm_r3));\n          });\n          i0.ɵɵelementStart(13, \"div\", 6)(14, \"input\", 11, 1);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function AdministrarUsuariosComponent_Template_input_ngModelChange_14_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.usuarioSeleccionado.email, $event) || (ctx.usuarioSeleccionado.email = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(16, AdministrarUsuariosComponent_div_16_Template, 2, 0, \"div\", 12);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"div\", 6)(18, \"div\", 13)(19, \"select\", 14);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function AdministrarUsuariosComponent_Template_select_ngModelChange_19_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.rolSeleccionado, $event) || (ctx.rolSeleccionado = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵtemplate(20, AdministrarUsuariosComponent_option_20_Template, 2, 1, \"option\", 15);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(21, \"button\", 16);\n          i0.ɵɵtext(22, \"Agregar\");\n          i0.ɵɵelementEnd()()()()();\n          i0.ɵɵelementStart(23, \"div\", 17)(24, \"table\", 18)(25, \"thead\")(26, \"tr\")(27, \"th\", 19);\n          i0.ɵɵtext(28, \"Usuario\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(29, \"th\", 19);\n          i0.ɵɵtext(30, \"Rol\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(31, \"th\", 19);\n          i0.ɵɵtext(32, \"Operaciones\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(33, \"tbody\");\n          i0.ɵɵtemplate(34, AdministrarUsuariosComponent_tr_34_Template, 12, 2, \"tr\", 15);\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          const usuarioForm_r3 = i0.ɵɵreference(12);\n          const email_r7 = i0.ɵɵreference(15);\n          i0.ɵɵproperty(\"ngIf\", ctx.hayError);\n          i0.ɵɵadvance(14);\n          i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(8, _c0, email_r7.invalid && email_r7.touched, email_r7.valid));\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.usuarioSeleccionado.email);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", email_r7.invalid && (email_r7.dirty || email_r7.touched));\n          i0.ɵɵadvance(3);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.rolSeleccionado);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngForOf\", ctx.roles);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"disabled\", !usuarioForm_r3.valid);\n          i0.ɵɵadvance(13);\n          i0.ɵɵproperty(\"ngForOf\", ctx.usuarioService.usuarios);\n        }\n      },\n      dependencies: [i4.NgClass, i4.NgForOf, i4.NgIf, i5.ɵNgNoValidate, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.DefaultValueAccessor, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.RequiredValidator, i5.PatternValidator, i5.EmailValidator, i5.NgModel, i5.NgForm, i6.NgbTooltip, i3.NgxSpinnerComponent],\n      styles: [\".container[_ngcontent-%COMP%]{color:#053667}.row[_ngcontent-%COMP%]{margin-top:10px}.card[_ngcontent-%COMP%]{text-align:center}.table[_ngcontent-%COMP%]{color:#053667}.label[_ngcontent-%COMP%]{margin-top:15px}.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:azure;cursor:pointer}.table[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{opacity:.3}\"]\n    });\n  }\n  return AdministrarUsuariosComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}